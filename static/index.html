<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Sine Wave Plot</title>
    <script src="https://cdn.plot.ly/plotly-2.27.0.min.js" charset="utf-8"></script>
</head>
<body>
    <div id="plot"></div>

    <script src="wasm_exec.js"></script>
    <script>
        const go = new Go(); // Instantiate the Go instance
        let mod, inst;
        WebAssembly.instantiateStreaming(fetch('solver_tests.wasm'), go.importObject).then((result) => {
            mod = result.module;
            inst = result.instance;
            go.run(inst); // Run the Go instance
            plotSineWaveAndDerivative(); // Call the plot function after the WASM module is loaded
        });

	function plotSineWaveAndDerivative() {
        // Fetch and parse the sine wave data
        const sineWaveData = JSON.parse(getSineWave());
        const sineWaveTrace = {
            x: sineWaveData.x,
            y: sineWaveData.sinWave,
            name: 'Sine Wave',
            type: 'scatter'
        };

        // Fetch and parse the first derivative data
        const derivativeData = JSON.parse(getFirstDerivative());
        const derivativeTrace = {
            x: derivativeData.x,
            y: derivativeData.df,
            name: 'First Derivative',
            type: 'scatter'
        };

        const layout = {
            title: 'Sine Wave and Its First Derivative',
            xaxis: {
                title: 'X'
            },
            yaxis: {
                title: 'Y'
            }
        };

        // Plot both the sine wave and its derivative
        Plotly.newPlot('plot', [sineWaveTrace, derivativeTrace], layout);
    }
    </script>
</body>
</html>
